

#这是第一个实例的日志
[Consumer clientId=consumer-user_behavior_group_springboot_manual-1, groupId=user_behavior_group_springboot_manual] Resetting the last seen epoch of partition user_behavior_logs-1 to 0 since the associated topicId changed from null to 8AePBStFQniS2-FES3esJg
2025-07-30T01:27:18.992+08:00  INFO 22477 --- [ntainer#0-0-C-1] org.apache.kafka.clients.Metadata        : [Consumer clientId=consumer-rebalance_demo_group-2, groupId=rebalance_demo_group] Resetting the last seen epoch of partition user_behavior_logs-1 to 0 since the associated topicId changed from null to 8AePBStFQniS2-FES3esJg
2025-07-30T01:27:18.992+08:00  INFO 22477 --- [ntainer#1-0-C-1] org.apache.kafka.clients.Metadata        : [Consumer clientId=consumer-user_behavior_group_springboot-3, groupId=user_behavior_group_springboot] Resetting the last seen epoch of partition user_behavior_logs-1 to 0 since the associated topicId changed from null to 8AePBStFQniS2-FES3esJg
2025-07-30T01:27:18.992+08:00  INFO 22477 --- [ntainer#2-0-C-1] org.apache.kafka.clients.Metadata        : [Consumer clientId=consumer-user_behavior_group_springboot_manual-1, groupId=user_behavior_group_springboot_manual] Resetting the last seen epoch of partition user_behavior_logs-2 to 0 since the associated topicId changed from null to 8AePBStFQniS2-FES3esJg
2025-07-30T01:27:18.992+08:00  INFO 22477 --- [ntainer#1-0-C-1] org.apache.kafka.clients.Metadata        : [Consumer clientId=consumer-user_behavior_group_springboot-3, groupId=user_behavior_group_springboot] Resetting the last seen epoch of partition user_behavior_logs-2 to 0 since the associated topicId changed from null to 8AePBStFQniS2-FES3esJg
2025-07-30T01:27:18.992+08:00  INFO 22477 --- [ntainer#2-0-C-1] org.apache.kafka.clients.Metadata        : [Consumer clientId=consumer-user_behavior_group_springboot_manual-1, groupId=user_behavior_group_springboot_manual] Resetting the last seen epoch of partition user_behavior_logs-0 to 0 since the associated topicId changed from null to 8AePBStFQniS2-FES3esJg
2025-07-30T01:27:18.992+08:00  INFO 22477 --- [ntainer#0-0-C-1] org.apache.kafka.clients.Metadata        : [Consumer clientId=consumer-rebalance_demo_group-2, groupId=rebalance_demo_group] Resetting the last seen epoch of partition user_behavior_logs-2 to 0 since the associated topicId changed from null to 8AePBStFQniS2-FES3esJg
2025-07-30T01:27:18.992+08:00  INFO 22477 --- [ntainer#0-0-C-1] org.apache.kafka.clients.Metadata        : [Consumer clientId=consumer-rebalance_demo_group-2, groupId=rebalance_demo_group] Resetting the last seen epoch of partition user_behavior_logs-0 to 0 since the associated topicId changed from null to 8AePBStFQniS2-FES3esJg
2025-07-30T01:27:18.992+08:00  INFO 22477 --- [ntainer#1-0-C-1] org.apache.kafka.clients.Metadata        : [Consumer clientId=consumer-user_behavior_group_springboot-3, groupId=user_behavior_group_springboot] Resetting the last seen epoch of partition user_behavior_logs-0 to 0 since the associated topicId changed from null to 8AePBStFQniS2-FES3esJg
2025-07-30T01:27:18.993+08:00  INFO 22477 --- [ntainer#2-0-C-1] org.apache.kafka.clients.Metadata        : [Consumer clientId=consumer-user_behavior_group_springboot_manual-1, groupId=user_behavior_group_springboot_manual] Cluster ID: INBN-lzyQ2aSZaZbVGfIMw
2025-07-30T01:27:18.993+08:00  INFO 22477 --- [ntainer#1-0-C-1] org.apache.kafka.clients.Metadata        : [Consumer clientId=consumer-user_behavior_group_springboot-3, groupId=user_behavior_group_springboot] Cluster ID: INBN-lzyQ2aSZaZbVGfIMw
2025-07-30T01:27:18.993+08:00  INFO 22477 --- [ntainer#0-0-C-1] org.apache.kafka.clients.Metadata        : [Consumer clientId=consumer-rebalance_demo_group-2, groupId=rebalance_demo_group] Cluster ID: INBN-lzyQ2aSZaZbVGfIMw
2025-07-30T01:27:18.994+08:00  INFO 22477 --- [ntainer#2-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-user_behavior_group_springboot_manual-1, groupId=user_behavior_group_springboot_manual] Discovered group coordinator localhost:9092 (id: 2147483646 rack: null)
2025-07-30T01:27:18.994+08:00  INFO 22477 --- [ntainer#0-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-rebalance_demo_group-2, groupId=rebalance_demo_group] Discovered group coordinator localhost:9092 (id: 2147483646 rack: null)
2025-07-30T01:27:18.994+08:00  INFO 22477 --- [ntainer#1-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-user_behavior_group_springboot-3, groupId=user_behavior_group_springboot] Discovered group coordinator localhost:9092 (id: 2147483646 rack: null)
2025-07-30T01:27:18.996+08:00  INFO 22477 --- [ntainer#2-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-user_behavior_group_springboot_manual-1, groupId=user_behavior_group_springboot_manual] (Re-)joining group
2025-07-30T01:27:18.999+08:00  INFO 22477 --- [ntainer#0-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-rebalance_demo_group-2, groupId=rebalance_demo_group] (Re-)joining group
2025-07-30T01:27:18.999+08:00  INFO 22477 --- [ntainer#1-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-user_behavior_group_springboot-3, groupId=user_behavior_group_springboot] (Re-)joining group
2025-07-30T01:27:19.004+08:00  INFO 22477 --- [ntainer#0-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-rebalance_demo_group-2, groupId=rebalance_demo_group] Request joining group due to: need to re-join with the given member-id: consumer-rebalance_demo_group-2-c56fd5d1-d17e-4f82-bcfc-0f217f77996c
2025-07-30T01:27:19.004+08:00  INFO 22477 --- [ntainer#1-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-user_behavior_group_springboot-3, groupId=user_behavior_group_springboot] Request joining group due to: need to re-join with the given member-id: consumer-user_behavior_group_springboot-3-fac6478c-86c1-450b-9275-45be54520150
2025-07-30T01:27:19.004+08:00  INFO 22477 --- [ntainer#1-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-user_behavior_group_springboot-3, groupId=user_behavior_group_springboot] Request joining group due to: rebalance failed due to 'The group member needs to have a valid member id before actually entering a consumer group.' (MemberIdRequiredException)
2025-07-30T01:27:19.004+08:00  INFO 22477 --- [ntainer#0-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-rebalance_demo_group-2, groupId=rebalance_demo_group] Request joining group due to: rebalance failed due to 'The group member needs to have a valid member id before actually entering a consumer group.' (MemberIdRequiredException)
2025-07-30T01:27:19.004+08:00  INFO 22477 --- [ntainer#1-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-user_behavior_group_springboot-3, groupId=user_behavior_group_springboot] (Re-)joining group
2025-07-30T01:27:19.004+08:00  INFO 22477 --- [ntainer#0-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-rebalance_demo_group-2, groupId=rebalance_demo_group] (Re-)joining group
2025-07-30T01:27:19.005+08:00  INFO 22477 --- [ntainer#2-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-user_behavior_group_springboot_manual-1, groupId=user_behavior_group_springboot_manual] Request joining group due to: need to re-join with the given member-id: consumer-user_behavior_group_springboot_manual-1-f6a028fd-d1c1-4f52-a58b-b47ec4cbb117
2025-07-30T01:27:19.006+08:00  INFO 22477 --- [ntainer#2-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-user_behavior_group_springboot_manual-1, groupId=user_behavior_group_springboot_manual] Request joining group due to: rebalance failed due to 'The group member needs to have a valid member id before actually entering a consumer group.' (MemberIdRequiredException)
2025-07-30T01:27:19.006+08:00  INFO 22477 --- [ntainer#2-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-user_behavior_group_springboot_manual-1, groupId=user_behavior_group_springboot_manual] (Re-)joining group
2025-07-30T01:27:22.006+08:00  INFO 22477 --- [ntainer#0-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-rebalance_demo_group-2, groupId=rebalance_demo_group] Successfully joined group with generation Generation{generationId=1, memberId='consumer-rebalance_demo_group-2-c56fd5d1-d17e-4f82-bcfc-0f217f77996c', protocol='range'}
2025-07-30T01:27:22.006+08:00  INFO 22477 --- [ntainer#1-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-user_behavior_group_springboot-3, groupId=user_behavior_group_springboot] Successfully joined group with generation Generation{generationId=41, memberId='consumer-user_behavior_group_springboot-3-fac6478c-86c1-450b-9275-45be54520150', protocol='range'}
2025-07-30T01:27:22.007+08:00  INFO 22477 --- [ntainer#0-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-rebalance_demo_group-2, groupId=rebalance_demo_group] Finished assignment for group at generation 1: {consumer-rebalance_demo_group-2-c56fd5d1-d17e-4f82-bcfc-0f217f77996c=Assignment(partitions=[user_behavior_logs-0, user_behavior_logs-1, user_behavior_logs-2])}
2025-07-30T01:27:22.007+08:00  INFO 22477 --- [ntainer#1-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-user_behavior_group_springboot-3, groupId=user_behavior_group_springboot] Finished assignment for group at generation 41: {consumer-user_behavior_group_springboot-3-fac6478c-86c1-450b-9275-45be54520150=Assignment(partitions=[user_behavior_logs-0, user_behavior_logs-1, user_behavior_logs-2])}
2025-07-30T01:27:22.008+08:00  INFO 22477 --- [ntainer#2-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-user_behavior_group_springboot_manual-1, groupId=user_behavior_group_springboot_manual] Successfully joined group with generation Generation{generationId=38, memberId='consumer-user_behavior_group_springboot_manual-1-f6a028fd-d1c1-4f52-a58b-b47ec4cbb117', protocol='range'}
2025-07-30T01:27:22.008+08:00  INFO 22477 --- [ntainer#2-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-user_behavior_group_springboot_manual-1, groupId=user_behavior_group_springboot_manual] Finished assignment for group at generation 38: {consumer-user_behavior_group_springboot_manual-1-f6a028fd-d1c1-4f52-a58b-b47ec4cbb117=Assignment(partitions=[user_behavior_logs-0, user_behavior_logs-1, user_behavior_logs-2])}
2025-07-30T01:27:22.016+08:00  INFO 22477 --- [ntainer#1-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-user_behavior_group_springboot-3, groupId=user_behavior_group_springboot] Successfully synced group in generation Generation{generationId=41, memberId='consumer-user_behavior_group_springboot-3-fac6478c-86c1-450b-9275-45be54520150', protocol='range'}
2025-07-30T01:27:22.016+08:00  INFO 22477 --- [ntainer#2-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-user_behavior_group_springboot_manual-1, groupId=user_behavior_group_springboot_manual] Successfully synced group in generation Generation{generationId=38, memberId='consumer-user_behavior_group_springboot_manual-1-f6a028fd-d1c1-4f52-a58b-b47ec4cbb117', protocol='range'}
2025-07-30T01:27:22.016+08:00  INFO 22477 --- [ntainer#0-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-rebalance_demo_group-2, groupId=rebalance_demo_group] Successfully synced group in generation Generation{generationId=1, memberId='consumer-rebalance_demo_group-2-c56fd5d1-d17e-4f82-bcfc-0f217f77996c', protocol='range'}
2025-07-30T01:27:22.016+08:00  INFO 22477 --- [ntainer#1-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-user_behavior_group_springboot-3, groupId=user_behavior_group_springboot] Notifying assignor about the new Assignment(partitions=[user_behavior_logs-0, user_behavior_logs-1, user_behavior_logs-2])
2025-07-30T01:27:22.016+08:00  INFO 22477 --- [ntainer#2-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-user_behavior_group_springboot_manual-1, groupId=user_behavior_group_springboot_manual] Notifying assignor about the new Assignment(partitions=[user_behavior_logs-0, user_behavior_logs-1, user_behavior_logs-2])
2025-07-30T01:27:22.016+08:00  INFO 22477 --- [ntainer#0-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-rebalance_demo_group-2, groupId=rebalance_demo_group] Notifying assignor about the new Assignment(partitions=[user_behavior_logs-0, user_behavior_logs-1, user_behavior_logs-2])
2025-07-30T01:27:22.018+08:00  INFO 22477 --- [ntainer#1-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-user_behavior_group_springboot-3, groupId=user_behavior_group_springboot] Adding newly assigned partitions: user_behavior_logs-0, user_behavior_logs-1, user_behavior_logs-2
2025-07-30T01:27:22.019+08:00  INFO 22477 --- [ntainer#2-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-user_behavior_group_springboot_manual-1, groupId=user_behavior_group_springboot_manual] Adding newly assigned partitions: user_behavior_logs-0, user_behavior_logs-1, user_behavior_logs-2
2025-07-30T01:27:22.019+08:00  INFO 22477 --- [ntainer#0-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-rebalance_demo_group-2, groupId=rebalance_demo_group] Adding newly assigned partitions: user_behavior_logs-0, user_behavior_logs-1, user_behavior_logs-2
2025-07-30T01:27:22.024+08:00  INFO 22477 --- [ntainer#0-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-rebalance_demo_group-2, groupId=rebalance_demo_group] Found no committed offset for partition user_behavior_logs-2
2025-07-30T01:27:22.024+08:00  INFO 22477 --- [ntainer#0-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-rebalance_demo_group-2, groupId=rebalance_demo_group] Found no committed offset for partition user_behavior_logs-1
2025-07-30T01:27:22.024+08:00  INFO 22477 --- [ntainer#0-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-rebalance_demo_group-2, groupId=rebalance_demo_group] Found no committed offset for partition user_behavior_logs-0
2025-07-30T01:27:22.025+08:00  INFO 22477 --- [ntainer#1-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-user_behavior_group_springboot-3, groupId=user_behavior_group_springboot] Setting offset for partition user_behavior_logs-2 to the committed offset FetchPosition{offset=90, offsetEpoch=Optional[0], currentLeader=LeaderAndEpoch{leader=Optional[localhost:9092 (id: 1 rack: null)], epoch=0}}
2025-07-30T01:27:22.025+08:00  INFO 22477 --- [ntainer#2-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-user_behavior_group_springboot_manual-1, groupId=user_behavior_group_springboot_manual] Setting offset for partition user_behavior_logs-2 to the committed offset FetchPosition{offset=90, offsetEpoch=Optional.empty, currentLeader=LeaderAndEpoch{leader=Optional[localhost:9092 (id: 1 rack: null)], epoch=0}}
2025-07-30T01:27:22.025+08:00  INFO 22477 --- [ntainer#1-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-user_behavior_group_springboot-3, groupId=user_behavior_group_springboot] Setting offset for partition user_behavior_logs-1 to the committed offset FetchPosition{offset=73, offsetEpoch=Optional[0], currentLeader=LeaderAndEpoch{leader=Optional[localhost:9092 (id: 1 rack: null)], epoch=0}}
2025-07-30T01:27:22.025+08:00  INFO 22477 --- [ntainer#2-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-user_behavior_group_springboot_manual-1, groupId=user_behavior_group_springboot_manual] Setting offset for partition user_behavior_logs-1 to the committed offset FetchPosition{offset=73, offsetEpoch=Optional.empty, currentLeader=LeaderAndEpoch{leader=Optional[localhost:9092 (id: 1 rack: null)], epoch=0}}
2025-07-30T01:27:22.025+08:00  INFO 22477 --- [ntainer#1-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-user_behavior_group_springboot-3, groupId=user_behavior_group_springboot] Setting offset for partition user_behavior_logs-0 to the committed offset FetchPosition{offset=93, offsetEpoch=Optional[0], currentLeader=LeaderAndEpoch{leader=Optional[localhost:9092 (id: 1 rack: null)], epoch=0}}
2025-07-30T01:27:22.025+08:00  INFO 22477 --- [ntainer#2-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-user_behavior_group_springboot_manual-1, groupId=user_behavior_group_springboot_manual] Setting offset for partition user_behavior_logs-0 to the committed offset FetchPosition{offset=93, offsetEpoch=Optional.empty, currentLeader=LeaderAndEpoch{leader=Optional[localhost:9092 (id: 1 rack: null)], epoch=0}}
2025-07-30T01:27:22.026+08:00  INFO 22477 --- [ntainer#2-0-C-1] o.s.k.l.KafkaMessageListenerContainer    : user_behavior_group_springboot_manual: partitions assigned: [user_behavior_logs-0, user_behavior_logs-1, user_behavior_logs-2]
2025-07-30T01:27:22.030+08:00  INFO 22477 --- [ntainer#1-0-C-1] o.s.k.l.KafkaMessageListenerContainer    : user_behavior_group_springboot: partitions assigned: [user_behavior_logs-0, user_behavior_logs-1, user_behavior_logs-2]
2025-07-30T01:27:22.030+08:00  INFO 22477 --- [ntainer#0-0-C-1] o.a.k.c.c.internals.SubscriptionState    : [Consumer clientId=consumer-rebalance_demo_group-2, groupId=rebalance_demo_group] Resetting offset for partition user_behavior_logs-2 to position FetchPosition{offset=0, offsetEpoch=Optional.empty, currentLeader=LeaderAndEpoch{leader=Optional[localhost:9092 (id: 1 rack: null)], epoch=0}}.
2025-07-30T01:27:22.030+08:00  INFO 22477 --- [ntainer#0-0-C-1] o.a.k.c.c.internals.SubscriptionState    : [Consumer clientId=consumer-rebalance_demo_group-2, groupId=rebalance_demo_group] Resetting offset for partition user_behavior_logs-1 to position FetchPosition{offset=0, offsetEpoch=Optional.empty, currentLeader=LeaderAndEpoch{leader=Optional[localhost:9092 (id: 1 rack: null)], epoch=0}}.
2025-07-30T01:27:22.030+08:00  INFO 22477 --- [ntainer#0-0-C-1] o.a.k.c.c.internals.SubscriptionState    : [Consumer clientId=consumer-rebalance_demo_group-2, groupId=rebalance_demo_group] Resetting offset for partition user_behavior_logs-0 to position FetchPosition{offset=0, offsetEpoch=Optional.empty, currentLeader=LeaderAndEpoch{leader=Optional[localhost:9092 (id: 1 rack: null)], epoch=0}}.
2025-07-30T01:27:22.030+08:00  INFO 22477 --- [ntainer#0-0-C-1] s.h.service.RebalanceObserverService     : 📥 分区被分配 (Partitions Assigned) - 2025-07-30 01:27:22.030:
2025-07-30T01:27:22.030+08:00  INFO 22477 --- [ntainer#0-0-C-1] s.h.service.RebalanceObserverService     :    ✅ Topic: user_behavior_logs, Partition: 0 -> 当前消费者
2025-07-30T01:27:22.030+08:00  INFO 22477 --- [ntainer#0-0-C-1] s.h.service.RebalanceObserverService     :    ✅ Topic: user_behavior_logs, Partition: 1 -> 当前消费者
2025-07-30T01:27:22.030+08:00  INFO 22477 --- [ntainer#0-0-C-1] s.h.service.RebalanceObserverService     :    ✅ Topic: user_behavior_logs, Partition: 2 -> 当前消费者
2025-07-30T01:27:22.031+08:00  INFO 22477 --- [ntainer#0-0-C-1] s.h.service.RebalanceObserverService     : === 再平衡完成 #0 - 2025-07-30 01:27:22.030 ===
2025-07-30T01:27:22.031+08:00  INFO 22477 --- [ntainer#0-0-C-1] s.h.service.RebalanceObserverService     : 🎉 消费者现在拥有 3 个分区
2025-07-30T01:27:22.031+08:00  INFO 22477 --- [ntainer#0-0-C-1] s.h.service.RebalanceObserverService     : 📊 当前分区分配摘要:
2025-07-30T01:27:22.031+08:00  INFO 22477 --- [ntainer#0-0-C-1] s.h.service.RebalanceObserverService     :    总分区数: 3
2025-07-30T01:27:22.031+08:00  INFO 22477 --- [ntainer#0-0-C-1] s.h.service.RebalanceObserverService     :    Topic 'user_behavior_logs': 分区 [0, 1, 2]
2025-07-30T01:27:23.057+08:00  INFO 22477 --- [ntainer#0-0-C-1] s.h.s.RebalanceDemoConsumerService       : 🔥 Consumer-8222 处理了第 100 条消息 | Partition: 1 | Offset: 9
2025-07-30T01:27:23.057+08:00  INFO 22477 --- [ntainer#0-0-C-1] s.h.service.RebalanceObserverService     : 🔍 再平衡统计: 总共发生了 0 次再平衡
2025-07-30T01:27:24.070+08:00  INFO 22477 --- [ntainer#0-0-C-1] s.h.s.RebalanceDemoConsumerService       : 🔥 Consumer-8222 处理了第 200 条消息 | Partition: 0 | Offset: 36
2025-07-30T01:27:24.070+08:00  INFO 22477 --- [ntainer#0-0-C-1] s.h.service.RebalanceObserverService     : 🔍 再平衡统计: 总共发生了 0 次再平衡
2025-07-30T01:27:45.392+08:00  INFO 22477 --- [nio-8081-exec-1] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring DispatcherServlet 'dispatcherServlet'
2025-07-30T01:27:45.392+08:00  INFO 22477 --- [nio-8081-exec-1] o.s.web.servlet.DispatcherServlet        : Initializing Servlet 'dispatcherServlet'
2025-07-30T01:27:45.393+08:00  INFO 22477 --- [nio-8081-exec-1] o.s.web.servlet.DispatcherServlet        : Completed initialization in 1 ms
2025-07-30T01:27:46.013+08:00  INFO 22477 --- [ntainer#0-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-rebalance_demo_group-2, groupId=rebalance_demo_group] Request joining group due to: group is already rebalancing
2025-07-30T01:27:46.013+08:00  INFO 22477 --- [ntainer#1-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-user_behavior_group_springboot-3, groupId=user_behavior_group_springboot] Request joining group due to: group is already rebalancing
2025-07-30T01:27:46.013+08:00  INFO 22477 --- [ntainer#2-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-user_behavior_group_springboot_manual-1, groupId=user_behavior_group_springboot_manual] Request joining group due to: group is already rebalancing
2025-07-30T01:27:46.014+08:00  INFO 22477 --- [ntainer#2-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-user_behavior_group_springboot_manual-1, groupId=user_behavior_group_springboot_manual] Revoke previously assigned partitions user_behavior_logs-0, user_behavior_logs-1, user_behavior_logs-2
2025-07-30T01:27:46.014+08:00  INFO 22477 --- [ntainer#2-0-C-1] o.s.k.l.KafkaMessageListenerContainer    : user_behavior_group_springboot_manual: partitions revoked: [user_behavior_logs-0, user_behavior_logs-1, user_behavior_logs-2]
2025-07-30T01:27:46.015+08:00  INFO 22477 --- [ntainer#2-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-user_behavior_group_springboot_manual-1, groupId=user_behavior_group_springboot_manual] (Re-)joining group
2025-07-30T01:27:46.016+08:00  INFO 22477 --- [ntainer#2-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-user_behavior_group_springboot_manual-1, groupId=user_behavior_group_springboot_manual] Successfully joined group with generation Generation{generationId=39, memberId='consumer-user_behavior_group_springboot_manual-1-f6a028fd-d1c1-4f52-a58b-b47ec4cbb117', protocol='range'}
2025-07-30T01:27:46.016+08:00  INFO 22477 --- [ntainer#2-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-user_behavior_group_springboot_manual-1, groupId=user_behavior_group_springboot_manual] Finished assignment for group at generation 39: {consumer-user_behavior_group_springboot_manual-1-f6a028fd-d1c1-4f52-a58b-b47ec4cbb117=Assignment(partitions=[user_behavior_logs-2]), consumer-user_behavior_group_springboot_manual-1-72a37e2d-40f1-4e43-827a-b147a0bc1ab0=Assignment(partitions=[user_behavior_logs-0, user_behavior_logs-1])}
2025-07-30T01:27:46.020+08:00  INFO 22477 --- [ntainer#1-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-user_behavior_group_springboot-3, groupId=user_behavior_group_springboot] Revoke previously assigned partitions user_behavior_logs-0, user_behavior_logs-1, user_behavior_logs-2
2025-07-30T01:27:46.020+08:00  INFO 22477 --- [ntainer#0-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-rebalance_demo_group-2, groupId=rebalance_demo_group] Revoke previously assigned partitions user_behavior_logs-0, user_behavior_logs-1, user_behavior_logs-2
2025-07-30T01:27:46.020+08:00  INFO 22477 --- [ntainer#1-0-C-1] o.s.k.l.KafkaMessageListenerContainer    : user_behavior_group_springboot: partitions revoked: [user_behavior_logs-0, user_behavior_logs-1, user_behavior_logs-2]
2025-07-30T01:27:46.020+08:00  WARN 22477 --- [ntainer#0-0-C-1] s.h.service.RebalanceObserverService     : === 再平衡开始 #1 - 2025-07-30 01:27:46.020 ===
2025-07-30T01:27:46.020+08:00  WARN 22477 --- [ntainer#0-0-C-1] s.h.service.RebalanceObserverService     : 📤 分区被撤销 (Partitions Revoked):
2025-07-30T01:27:46.020+08:00  WARN 22477 --- [ntainer#0-0-C-1] s.h.service.RebalanceObserverService     :    ❌ Topic: user_behavior_logs, Partition: 0
2025-07-30T01:27:46.020+08:00  WARN 22477 --- [ntainer#0-0-C-1] s.h.service.RebalanceObserverService     :    ❌ Topic: user_behavior_logs, Partition: 1
2025-07-30T01:27:46.020+08:00  INFO 22477 --- [ntainer#1-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-user_behavior_group_springboot-3, groupId=user_behavior_group_springboot] (Re-)joining group
2025-07-30T01:27:46.020+08:00  WARN 22477 --- [ntainer#0-0-C-1] s.h.service.RebalanceObserverService     :    ❌ Topic: user_behavior_logs, Partition: 2
2025-07-30T01:27:46.020+08:00  WARN 22477 --- [ntainer#0-0-C-1] s.h.service.RebalanceObserverService     : 🔄 消费者正在释放分区所有权...
2025-07-30T01:27:46.022+08:00  INFO 22477 --- [ntainer#1-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-user_behavior_group_springboot-3, groupId=user_behavior_group_springboot] Successfully joined group with generation Generation{generationId=42, memberId='consumer-user_behavior_group_springboot-3-fac6478c-86c1-450b-9275-45be54520150', protocol='range'}
2025-07-30T01:27:46.022+08:00  INFO 22477 --- [ntainer#1-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-user_behavior_group_springboot-3, groupId=user_behavior_group_springboot] Finished assignment for group at generation 42: {consumer-user_behavior_group_springboot-3-2927932b-c72a-491f-b2f3-60e9f16ad136=Assignment(partitions=[user_behavior_logs-0, user_behavior_logs-1]), consumer-user_behavior_group_springboot-3-fac6478c-86c1-450b-9275-45be54520150=Assignment(partitions=[user_behavior_logs-2])}
2025-07-30T01:27:46.023+08:00  INFO 22477 --- [ntainer#2-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-user_behavior_group_springboot_manual-1, groupId=user_behavior_group_springboot_manual] Successfully synced group in generation Generation{generationId=39, memberId='consumer-user_behavior_group_springboot_manual-1-f6a028fd-d1c1-4f52-a58b-b47ec4cbb117', protocol='range'}
2025-07-30T01:27:46.023+08:00  INFO 22477 --- [ntainer#2-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-user_behavior_group_springboot_manual-1, groupId=user_behavior_group_springboot_manual] Notifying assignor about the new Assignment(partitions=[user_behavior_logs-2])
2025-07-30T01:27:46.023+08:00  INFO 22477 --- [ntainer#2-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-user_behavior_group_springboot_manual-1, groupId=user_behavior_group_springboot_manual] Adding newly assigned partitions: user_behavior_logs-2
2025-07-30T01:27:46.024+08:00  INFO 22477 --- [ntainer#2-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-user_behavior_group_springboot_manual-1, groupId=user_behavior_group_springboot_manual] Setting offset for partition user_behavior_logs-2 to the committed offset FetchPosition{offset=90, offsetEpoch=Optional.empty, currentLeader=LeaderAndEpoch{leader=Optional[localhost:9092 (id: 1 rack: null)], epoch=0}}
2025-07-30T01:27:46.024+08:00  INFO 22477 --- [ntainer#2-0-C-1] o.s.k.l.KafkaMessageListenerContainer    : user_behavior_group_springboot_manual: partitions assigned: [user_behavior_logs-2]
2025-07-30T01:27:46.029+08:00  INFO 22477 --- [ntainer#1-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-user_behavior_group_springboot-3, groupId=user_behavior_group_springboot] Successfully synced group in generation Generation{generationId=42, memberId='consumer-user_behavior_group_springboot-3-fac6478c-86c1-450b-9275-45be54520150', protocol='range'}
2025-07-30T01:27:46.029+08:00  INFO 22477 --- [ntainer#1-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-user_behavior_group_springboot-3, groupId=user_behavior_group_springboot] Notifying assignor about the new Assignment(partitions=[user_behavior_logs-2])
2025-07-30T01:27:46.029+08:00  INFO 22477 --- [ntainer#1-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-user_behavior_group_springboot-3, groupId=user_behavior_group_springboot] Adding newly assigned partitions: user_behavior_logs-2
2025-07-30T01:27:46.030+08:00  INFO 22477 --- [ntainer#1-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-user_behavior_group_springboot-3, groupId=user_behavior_group_springboot] Setting offset for partition user_behavior_logs-2 to the committed offset FetchPosition{offset=90, offsetEpoch=Optional[0], currentLeader=LeaderAndEpoch{leader=Optional[localhost:9092 (id: 1 rack: null)], epoch=0}}
2025-07-30T01:27:46.100+08:00  INFO 22477 --- [ntainer#1-0-C-1] o.s.k.l.KafkaMessageListenerContainer    : user_behavior_group_springboot: partitions assigned: [user_behavior_logs-2]
2025-07-30T01:27:46.121+08:00  INFO 22477 --- [ntainer#0-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-rebalance_demo_group-2, groupId=rebalance_demo_group] (Re-)joining group
2025-07-30T01:27:46.123+08:00  INFO 22477 --- [ntainer#0-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-rebalance_demo_group-2, groupId=rebalance_demo_group] Successfully joined group with generation Generation{generationId=2, memberId='consumer-rebalance_demo_group-2-c56fd5d1-d17e-4f82-bcfc-0f217f77996c', protocol='range'}
2025-07-30T01:27:46.123+08:00  INFO 22477 --- [ntainer#0-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-rebalance_demo_group-2, groupId=rebalance_demo_group] Finished assignment for group at generation 2: {consumer-rebalance_demo_group-2-c56fd5d1-d17e-4f82-bcfc-0f217f77996c=Assignment(partitions=[user_behavior_logs-2]), consumer-rebalance_demo_group-2-8a07e2c9-3610-4966-9ef9-c1748539e467=Assignment(partitions=[user_behavior_logs-0, user_behavior_logs-1])}
2025-07-30T01:27:46.130+08:00  INFO 22477 --- [ntainer#0-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-rebalance_demo_group-2, groupId=rebalance_demo_group] Successfully synced group in generation Generation{generationId=2, memberId='consumer-rebalance_demo_group-2-c56fd5d1-d17e-4f82-bcfc-0f217f77996c', protocol='range'}
2025-07-30T01:27:46.130+08:00  INFO 22477 --- [ntainer#0-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-rebalance_demo_group-2, groupId=rebalance_demo_group] Notifying assignor about the new Assignment(partitions=[user_behavior_logs-2])
2025-07-30T01:27:46.130+08:00  INFO 22477 --- [ntainer#0-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-rebalance_demo_group-2, groupId=rebalance_demo_group] Adding newly assigned partitions: user_behavior_logs-2
2025-07-30T01:27:46.131+08:00  INFO 22477 --- [ntainer#0-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-rebalance_demo_group-2, groupId=rebalance_demo_group] Setting offset for partition user_behavior_logs-2 to the committed offset FetchPosition{offset=90, offsetEpoch=Optional[0], currentLeader=LeaderAndEpoch{leader=Optional[localhost:9092 (id: 1 rack: null)], epoch=0}}
2025-07-30T01:27:46.210+08:00  INFO 22477 --- [ntainer#0-0-C-1] s.h.service.RebalanceObserverService     : 📥 分区被分配 (Partitions Assigned) - 2025-07-30 01:27:46.210:
2025-07-30T01:27:46.210+08:00  INFO 22477 --- [ntainer#0-0-C-1] s.h.service.RebalanceObserverService     :    ✅ Topic: user_behavior_logs, Partition: 2 -> 当前消费者
2025-07-30T01:27:46.210+08:00  INFO 22477 --- [ntainer#0-0-C-1] s.h.service.RebalanceObserverService     : === 再平衡完成 #1 - 2025-07-30 01:27:46.210 ===
2025-07-30T01:27:46.210+08:00  INFO 22477 --- [ntainer#0-0-C-1] s.h.service.RebalanceObserverService     : 🎉 消费者现在拥有 1 个分区
2025-07-30T01:27:46.210+08:00  INFO 22477 --- [ntainer#0-0-C-1] s.h.service.RebalanceObserverService     : 📊 当前分区分配摘要:
2025-07-30T01:27:46.210+08:00  INFO 22477 --- [ntainer#0-0-C-1] s.h.service.RebalanceObserverService     :    总分区数: 1
2025-07-30T01:27:46.210+08:00  INFO 22477 --- [ntainer#0-0-C-1] s.h.service.RebalanceObserverService     :    Topic 'user_behavior_logs': 分区 [2]
2025-07-30T01:28:10.023+08:00  INFO 22477 --- [ntainer#2-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-user_behavior_group_springboot_manual-1, groupId=user_behavior_group_springboot_manual] Request joining group due to: group is already rebalancing
2025-07-30T01:28:10.023+08:00  INFO 22477 --- [ntainer#2-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-user_behavior_group_springboot_manual-1, groupId=user_behavior_group_springboot_manual] Revoke previously assigned partitions user_behavior_logs-2
2025-07-30T01:28:10.023+08:00  INFO 22477 --- [ntainer#2-0-C-1] o.s.k.l.KafkaMessageListenerContainer    : user_behavior_group_springboot_manual: partitions revoked: [user_behavior_logs-2]
2025-07-30T01:28:10.023+08:00  INFO 22477 --- [ntainer#2-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-user_behavior_group_springboot_manual-1, groupId=user_behavior_group_springboot_manual] (Re-)joining group
2025-07-30T01:28:10.024+08:00  INFO 22477 --- [ntainer#2-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-user_behavior_group_springboot_manual-1, groupId=user_behavior_group_springboot_manual] Successfully joined group with generation Generation{generationId=40, memberId='consumer-user_behavior_group_springboot_manual-1-f6a028fd-d1c1-4f52-a58b-b47ec4cbb117', protocol='range'}
2025-07-30T01:28:10.025+08:00  INFO 22477 --- [ntainer#2-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-user_behavior_group_springboot_manual-1, groupId=user_behavior_group_springboot_manual] Finished assignment for group at generation 40: {consumer-user_behavior_group_springboot_manual-1-f6a028fd-d1c1-4f52-a58b-b47ec4cbb117=Assignment(partitions=[user_behavior_logs-0, user_behavior_logs-1, user_behavior_logs-2])}
2025-07-30T01:28:10.025+08:00  INFO 22477 --- [ntainer#1-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-user_behavior_group_springboot-3, groupId=user_behavior_group_springboot] Request joining group due to: group is already rebalancing
2025-07-30T01:28:10.032+08:00  INFO 22477 --- [ntainer#2-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-user_behavior_group_springboot_manual-1, groupId=user_behavior_group_springboot_manual] Successfully synced group in generation Generation{generationId=40, memberId='consumer-user_behavior_group_springboot_manual-1-f6a028fd-d1c1-4f52-a58b-b47ec4cbb117', protocol='range'}
2025-07-30T01:28:10.032+08:00  INFO 22477 --- [ntainer#1-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-user_behavior_group_springboot-3, groupId=user_behavior_group_springboot] Revoke previously assigned partitions user_behavior_logs-2
2025-07-30T01:28:10.032+08:00  INFO 22477 --- [ntainer#1-0-C-1] o.s.k.l.KafkaMessageListenerContainer    : user_behavior_group_springboot: partitions revoked: [user_behavior_logs-2]
2025-07-30T01:28:10.032+08:00  INFO 22477 --- [ntainer#2-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-user_behavior_group_springboot_manual-1, groupId=user_behavior_group_springboot_manual] Notifying assignor about the new Assignment(partitions=[user_behavior_logs-0, user_behavior_logs-1, user_behavior_logs-2])
2025-07-30T01:28:10.032+08:00  INFO 22477 --- [ntainer#1-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-user_behavior_group_springboot-3, groupId=user_behavior_group_springboot] (Re-)joining group
2025-07-30T01:28:10.033+08:00  INFO 22477 --- [ntainer#2-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-user_behavior_group_springboot_manual-1, groupId=user_behavior_group_springboot_manual] Adding newly assigned partitions: user_behavior_logs-0, user_behavior_logs-1, user_behavior_logs-2
2025-07-30T01:28:10.034+08:00  INFO 22477 --- [ntainer#2-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-user_behavior_group_springboot_manual-1, groupId=user_behavior_group_springboot_manual] Setting offset for partition user_behavior_logs-2 to the committed offset FetchPosition{offset=90, offsetEpoch=Optional.empty, currentLeader=LeaderAndEpoch{leader=Optional[localhost:9092 (id: 1 rack: null)], epoch=0}}
2025-07-30T01:28:10.034+08:00  INFO 22477 --- [ntainer#2-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-user_behavior_group_springboot_manual-1, groupId=user_behavior_group_springboot_manual] Setting offset for partition user_behavior_logs-1 to the committed offset FetchPosition{offset=73, offsetEpoch=Optional.empty, currentLeader=LeaderAndEpoch{leader=Optional[localhost:9092 (id: 1 rack: null)], epoch=0}}
2025-07-30T01:28:10.034+08:00  INFO 22477 --- [ntainer#2-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-user_behavior_group_springboot_manual-1, groupId=user_behavior_group_springboot_manual] Setting offset for partition user_behavior_logs-0 to the committed offset FetchPosition{offset=93, offsetEpoch=Optional.empty, currentLeader=LeaderAndEpoch{leader=Optional[localhost:9092 (id: 1 rack: null)], epoch=0}}
2025-07-30T01:28:10.034+08:00  INFO 22477 --- [ntainer#2-0-C-1] o.s.k.l.KafkaMessageListenerContainer    : user_behavior_group_springboot_manual: partitions assigned: [user_behavior_logs-0, user_behavior_logs-1, user_behavior_logs-2]
2025-07-30T01:28:10.034+08:00  INFO 22477 --- [ntainer#1-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-user_behavior_group_springboot-3, groupId=user_behavior_group_springboot] Successfully joined group with generation Generation{generationId=43, memberId='consumer-user_behavior_group_springboot-3-fac6478c-86c1-450b-9275-45be54520150', protocol='range'}
2025-07-30T01:28:10.034+08:00  INFO 22477 --- [ntainer#1-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-user_behavior_group_springboot-3, groupId=user_behavior_group_springboot] Finished assignment for group at generation 43: {consumer-user_behavior_group_springboot-3-fac6478c-86c1-450b-9275-45be54520150=Assignment(partitions=[user_behavior_logs-0, user_behavior_logs-1, user_behavior_logs-2])}
2025-07-30T01:28:10.041+08:00  INFO 22477 --- [ntainer#1-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-user_behavior_group_springboot-3, groupId=user_behavior_group_springboot] Successfully synced group in generation Generation{generationId=43, memberId='consumer-user_behavior_group_springboot-3-fac6478c-86c1-450b-9275-45be54520150', protocol='range'}
2025-07-30T01:28:10.041+08:00  INFO 22477 --- [ntainer#1-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-user_behavior_group_springboot-3, groupId=user_behavior_group_springboot] Notifying assignor about the new Assignment(partitions=[user_behavior_logs-0, user_behavior_logs-1, user_behavior_logs-2])
2025-07-30T01:28:10.041+08:00  INFO 22477 --- [ntainer#1-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-user_behavior_group_springboot-3, groupId=user_behavior_group_springboot] Adding newly assigned partitions: user_behavior_logs-0, user_behavior_logs-1, user_behavior_logs-2
2025-07-30T01:28:10.042+08:00  INFO 22477 --- [ntainer#1-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-user_behavior_group_springboot-3, groupId=user_behavior_group_springboot] Setting offset for partition user_behavior_logs-2 to the committed offset FetchPosition{offset=90, offsetEpoch=Optional[0], currentLeader=LeaderAndEpoch{leader=Optional[localhost:9092 (id: 1 rack: null)], epoch=0}}
2025-07-30T01:28:10.042+08:00  INFO 22477 --- [ntainer#1-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-user_behavior_group_springboot-3, groupId=user_behavior_group_springboot] Setting offset for partition user_behavior_logs-1 to the committed offset FetchPosition{offset=73, offsetEpoch=Optional[0], currentLeader=LeaderAndEpoch{leader=Optional[localhost:9092 (id: 1 rack: null)], epoch=0}}
2025-07-30T01:28:10.042+08:00  INFO 22477 --- [ntainer#1-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-user_behavior_group_springboot-3, groupId=user_behavior_group_springboot] Setting offset for partition user_behavior_logs-0 to the committed offset FetchPosition{offset=93, offsetEpoch=Optional[0], currentLeader=LeaderAndEpoch{leader=Optional[localhost:9092 (id: 1 rack: null)], epoch=0}}
2025-07-30T01:28:10.127+08:00  INFO 22477 --- [ntainer#0-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-rebalance_demo_group-2, groupId=rebalance_demo_group] Request joining group due to: group is already rebalancing
2025-07-30T01:28:10.134+08:00  INFO 22477 --- [ntainer#0-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-rebalance_demo_group-2, groupId=rebalance_demo_group] Revoke previously assigned partitions user_behavior_logs-2
2025-07-30T01:28:10.134+08:00  WARN 22477 --- [ntainer#0-0-C-1] s.h.service.RebalanceObserverService     : === 再平衡开始 #2 - 2025-07-30 01:28:10.134 ===
2025-07-30T01:28:10.134+08:00  WARN 22477 --- [ntainer#0-0-C-1] s.h.service.RebalanceObserverService     : 📤 分区被撤销 (Partitions Revoked):
2025-07-30T01:28:10.134+08:00  WARN 22477 --- [ntainer#0-0-C-1] s.h.service.RebalanceObserverService     :    ❌ Topic: user_behavior_logs, Partition: 2
2025-07-30T01:28:10.134+08:00  WARN 22477 --- [ntainer#0-0-C-1] s.h.service.RebalanceObserverService     : 🔄 消费者正在释放分区所有权...
2025-07-30T01:28:10.149+08:00  INFO 22477 --- [ntainer#1-0-C-1] o.s.k.l.KafkaMessageListenerContainer    : user_behavior_group_springboot: partitions assigned: [user_behavior_logs-0, user_behavior_logs-1, user_behavior_logs-2]
2025-07-30T01:28:10.234+08:00  INFO 22477 --- [ntainer#0-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-rebalance_demo_group-2, groupId=rebalance_demo_group] (Re-)joining group
2025-07-30T01:28:10.235+08:00  INFO 22477 --- [ntainer#0-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-rebalance_demo_group-2, groupId=rebalance_demo_group] Successfully joined group with generation Generation{generationId=3, memberId='consumer-rebalance_demo_group-2-c56fd5d1-d17e-4f82-bcfc-0f217f77996c', protocol='range'}
2025-07-30T01:28:10.236+08:00  INFO 22477 --- [ntainer#0-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-rebalance_demo_group-2, groupId=rebalance_demo_group] Finished assignment for group at generation 3: {consumer-rebalance_demo_group-2-c56fd5d1-d17e-4f82-bcfc-0f217f77996c=Assignment(partitions=[user_behavior_logs-0, user_behavior_logs-1, user_behavior_logs-2])}
2025-07-30T01:28:10.242+08:00  INFO 22477 --- [ntainer#0-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-rebalance_demo_group-2, groupId=rebalance_demo_group] Successfully synced group in generation Generation{generationId=3, memberId='consumer-rebalance_demo_group-2-c56fd5d1-d17e-4f82-bcfc-0f217f77996c', protocol='range'}
2025-07-30T01:28:10.242+08:00  INFO 22477 --- [ntainer#0-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-rebalance_demo_group-2, groupId=rebalance_demo_group] Notifying assignor about the new Assignment(partitions=[user_behavior_logs-0, user_behavior_logs-1, user_behavior_logs-2])
2025-07-30T01:28:10.242+08:00  INFO 22477 --- [ntainer#0-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-rebalance_demo_group-2, groupId=rebalance_demo_group] Adding newly assigned partitions: user_behavior_logs-0, user_behavior_logs-1, user_behavior_logs-2
2025-07-30T01:28:10.242+08:00  INFO 22477 --- [ntainer#0-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-rebalance_demo_group-2, groupId=rebalance_demo_group] Setting offset for partition user_behavior_logs-2 to the committed offset FetchPosition{offset=90, offsetEpoch=Optional[0], currentLeader=LeaderAndEpoch{leader=Optional[localhost:9092 (id: 1 rack: null)], epoch=0}}
2025-07-30T01:28:10.242+08:00  INFO 22477 --- [ntainer#0-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-rebalance_demo_group-2, groupId=rebalance_demo_group] Setting offset for partition user_behavior_logs-1 to the committed offset FetchPosition{offset=73, offsetEpoch=Optional[0], currentLeader=LeaderAndEpoch{leader=Optional[localhost:9092 (id: 1 rack: null)], epoch=0}}
2025-07-30T01:28:10.242+08:00  INFO 22477 --- [ntainer#0-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-rebalance_demo_group-2, groupId=rebalance_demo_group] Setting offset for partition user_behavior_logs-0 to the committed offset FetchPosition{offset=93, offsetEpoch=Optional[0], currentLeader=LeaderAndEpoch{leader=Optional[localhost:9092 (id: 1 rack: null)], epoch=0}}
2025-07-30T01:28:10.265+08:00  INFO 22477 --- [ntainer#0-0-C-1] s.h.service.RebalanceObserverService     : 📥 分区被分配 (Partitions Assigned) - 2025-07-30 01:28:10.265:
2025-07-30T01:28:10.266+08:00  INFO 22477 --- [ntainer#0-0-C-1] s.h.service.RebalanceObserverService     :    ✅ Topic: user_behavior_logs, Partition: 0 -> 当前消费者
2025-07-30T01:28:10.266+08:00  INFO 22477 --- [ntainer#0-0-C-1] s.h.service.RebalanceObserverService     :    ✅ Topic: user_behavior_logs, Partition: 1 -> 当前消费者
2025-07-30T01:28:10.266+08:00  INFO 22477 --- [ntainer#0-0-C-1] s.h.service.RebalanceObserverService     :    ✅ Topic: user_behavior_logs, Partition: 2 -> 当前消费者
2025-07-30T01:28:10.266+08:00  INFO 22477 --- [ntainer#0-0-C-1] s.h.service.RebalanceObserverService     : === 再平衡完成 #2 - 2025-07-30 01:28:10.265 ===
2025-07-30T01:28:10.266+08:00  INFO 22477 --- [ntainer#0-0-C-1] s.h.service.RebalanceObserverService     : 🎉 消费者现在拥有 3 个分区
2025-07-30T01:28:10.266+08:00  INFO 22477 --- [ntainer#0-0-C-1] s.h.service.RebalanceObserverService     : 📊 当前分区分配摘要:
2025-07-30T01:28:10.266+08:00  INFO 22477 --- [ntainer#0-0-C-1] s.h.service.RebalanceObserverService     :    总分区数: 3
2025-07-30T01:28:10.266+08:00  INFO 22477 --- [ntainer#0-0-C-1] s.h.service.RebalanceObserverService     :    Topic 'user_behavior_logs': 分区 [0, 1, 2]


#
这是第二个实例的日志

025-07-30T01:27:44.290+08:00  INFO 22801 --- [           main] o.a.k.clients.consumer.KafkaConsumer     : [Consumer clientId=consumer-user_behavior_group_springboot-3, groupId=user_behavior_group_springboot] Subscribed to topic(s): user_behavior_logs
2025-07-30T01:27:44.296+08:00  INFO 22801 --- [           main] s.h.kafkademo.KafkaDemoApplication       : Started KafkaDemoApplication in 1.841 seconds (process running for 2.116)
2025-07-30T01:27:44.297+08:00  INFO 22801 --- [           main] s.h.k.component.KafkaStartupComponent    : === Kafka Demo Application Started ===
2025-07-30T01:27:44.297+08:00  INFO 22801 --- [           main] s.h.k.component.KafkaStartupComponent    : 应用启动完成，Kafka消息发送服务已就绪
2025-07-30T01:27:44.297+08:00  INFO 22801 --- [           main] s.h.k.component.KafkaStartupComponent    : 可以通过以下API控制:
2025-07-30T01:27:44.297+08:00  INFO 22801 --- [           main] s.h.k.component.KafkaStartupComponent    : - POST /kafka/start?acks=all  - 开始发送消息
2025-07-30T01:27:44.297+08:00  INFO 22801 --- [           main] s.h.k.component.KafkaStartupComponent    : - POST /kafka/stop            - 停止发送消息
2025-07-30T01:27:44.297+08:00  INFO 22801 --- [           main] s.h.k.component.KafkaStartupComponent    : - GET  /kafka/status          - 查看状态
2025-07-30T01:27:44.297+08:00  INFO 22801 --- [           main] s.h.k.component.KafkaStartupComponent    : - POST /kafka/send-single     - 发送单条消息
2025-07-30T01:27:44.297+08:00  INFO 22801 --- [           main] s.h.k.component.KafkaStartupComponent    : - 访问 http://localhost:8080 打开控制台
2025-07-30T01:27:44.298+08:00  INFO 22801 --- [           main] s.h.kafkademo.KafkaDemoApplication       : === Kafka Demo 应用启动完成 ===
2025-07-30T01:27:44.298+08:00  INFO 22801 --- [           main] s.h.kafkademo.KafkaDemoApplication       : 访问 http://localhost:8080 查看控制台
2025-07-30T01:27:44.452+08:00  INFO 22801 --- [ntainer#2-0-C-1] org.apache.kafka.clients.Metadata        : [Consumer clientId=consumer-user_behavior_group_springboot_manual-1, groupId=user_behavior_group_springboot_manual] Resetting the last seen epoch of partition user_behavior_logs-1 to 0 since the associated topicId changed from null to 8AePBStFQniS2-FES3esJg
2025-07-30T01:27:44.452+08:00  INFO 22801 --- [ntainer#0-0-C-1] org.apache.kafka.clients.Metadata        : [Consumer clientId=consumer-rebalance_demo_group-2, groupId=rebalance_demo_group] Resetting the last seen epoch of partition user_behavior_logs-1 to 0 since the associated topicId changed from null to 8AePBStFQniS2-FES3esJg
2025-07-30T01:27:44.452+08:00  INFO 22801 --- [ntainer#1-0-C-1] org.apache.kafka.clients.Metadata        : [Consumer clientId=consumer-user_behavior_group_springboot-3, groupId=user_behavior_group_springboot] Resetting the last seen epoch of partition user_behavior_logs-1 to 0 since the associated topicId changed from null to 8AePBStFQniS2-FES3esJg
2025-07-30T01:27:44.452+08:00  INFO 22801 --- [ntainer#2-0-C-1] org.apache.kafka.clients.Metadata        : [Consumer clientId=consumer-user_behavior_group_springboot_manual-1, groupId=user_behavior_group_springboot_manual] Resetting the last seen epoch of partition user_behavior_logs-2 to 0 since the associated topicId changed from null to 8AePBStFQniS2-FES3esJg
2025-07-30T01:27:44.452+08:00  INFO 22801 --- [ntainer#2-0-C-1] org.apache.kafka.clients.Metadata        : [Consumer clientId=consumer-user_behavior_group_springboot_manual-1, groupId=user_behavior_group_springboot_manual] Resetting the last seen epoch of partition user_behavior_logs-0 to 0 since the associated topicId changed from null to 8AePBStFQniS2-FES3esJg
2025-07-30T01:27:44.452+08:00  INFO 22801 --- [ntainer#1-0-C-1] org.apache.kafka.clients.Metadata        : [Consumer clientId=consumer-user_behavior_group_springboot-3, groupId=user_behavior_group_springboot] Resetting the last seen epoch of partition user_behavior_logs-2 to 0 since the associated topicId changed from null to 8AePBStFQniS2-FES3esJg
2025-07-30T01:27:44.452+08:00  INFO 22801 --- [ntainer#0-0-C-1] org.apache.kafka.clients.Metadata        : [Consumer clientId=consumer-rebalance_demo_group-2, groupId=rebalance_demo_group] Resetting the last seen epoch of partition user_behavior_logs-2 to 0 since the associated topicId changed from null to 8AePBStFQniS2-FES3esJg
2025-07-30T01:27:44.452+08:00  INFO 22801 --- [ntainer#1-0-C-1] org.apache.kafka.clients.Metadata        : [Consumer clientId=consumer-user_behavior_group_springboot-3, groupId=user_behavior_group_springboot] Resetting the last seen epoch of partition user_behavior_logs-0 to 0 since the associated topicId changed from null to 8AePBStFQniS2-FES3esJg
2025-07-30T01:27:44.452+08:00  INFO 22801 --- [ntainer#0-0-C-1] org.apache.kafka.clients.Metadata        : [Consumer clientId=consumer-rebalance_demo_group-2, groupId=rebalance_demo_group] Resetting the last seen epoch of partition user_behavior_logs-0 to 0 since the associated topicId changed from null to 8AePBStFQniS2-FES3esJg
2025-07-30T01:27:44.453+08:00  INFO 22801 --- [ntainer#2-0-C-1] org.apache.kafka.clients.Metadata        : [Consumer clientId=consumer-user_behavior_group_springboot_manual-1, groupId=user_behavior_group_springboot_manual] Cluster ID: INBN-lzyQ2aSZaZbVGfIMw
2025-07-30T01:27:44.453+08:00  INFO 22801 --- [ntainer#0-0-C-1] org.apache.kafka.clients.Metadata        : [Consumer clientId=consumer-rebalance_demo_group-2, groupId=rebalance_demo_group] Cluster ID: INBN-lzyQ2aSZaZbVGfIMw
2025-07-30T01:27:44.453+08:00  INFO 22801 --- [ntainer#1-0-C-1] org.apache.kafka.clients.Metadata        : [Consumer clientId=consumer-user_behavior_group_springboot-3, groupId=user_behavior_group_springboot] Cluster ID: INBN-lzyQ2aSZaZbVGfIMw
2025-07-30T01:27:44.454+08:00  INFO 22801 --- [ntainer#2-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-user_behavior_group_springboot_manual-1, groupId=user_behavior_group_springboot_manual] Discovered group coordinator localhost:9092 (id: 2147483646 rack: null)
2025-07-30T01:27:44.454+08:00  INFO 22801 --- [ntainer#1-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-user_behavior_group_springboot-3, groupId=user_behavior_group_springboot] Discovered group coordinator localhost:9092 (id: 2147483646 rack: null)
2025-07-30T01:27:44.454+08:00  INFO 22801 --- [ntainer#0-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-rebalance_demo_group-2, groupId=rebalance_demo_group] Discovered group coordinator localhost:9092 (id: 2147483646 rack: null)
2025-07-30T01:27:44.455+08:00  INFO 22801 --- [ntainer#2-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-user_behavior_group_springboot_manual-1, groupId=user_behavior_group_springboot_manual] (Re-)joining group
2025-07-30T01:27:44.456+08:00  INFO 22801 --- [ntainer#0-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-rebalance_demo_group-2, groupId=rebalance_demo_group] (Re-)joining group
2025-07-30T01:27:44.456+08:00  INFO 22801 --- [ntainer#1-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-user_behavior_group_springboot-3, groupId=user_behavior_group_springboot] (Re-)joining group
2025-07-30T01:27:44.462+08:00  INFO 22801 --- [ntainer#0-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-rebalance_demo_group-2, groupId=rebalance_demo_group] Request joining group due to: need to re-join with the given member-id: consumer-rebalance_demo_group-2-8a07e2c9-3610-4966-9ef9-c1748539e467
2025-07-30T01:27:44.462+08:00  INFO 22801 --- [ntainer#1-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-user_behavior_group_springboot-3, groupId=user_behavior_group_springboot] Request joining group due to: need to re-join with the given member-id: consumer-user_behavior_group_springboot-3-2927932b-c72a-491f-b2f3-60e9f16ad136
2025-07-30T01:27:44.463+08:00  INFO 22801 --- [ntainer#0-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-rebalance_demo_group-2, groupId=rebalance_demo_group] Request joining group due to: rebalance failed due to 'The group member needs to have a valid member id before actually entering a consumer group.' (MemberIdRequiredException)
2025-07-30T01:27:44.463+08:00  INFO 22801 --- [ntainer#1-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-user_behavior_group_springboot-3, groupId=user_behavior_group_springboot] Request joining group due to: rebalance failed due to 'The group member needs to have a valid member id before actually entering a consumer group.' (MemberIdRequiredException)
2025-07-30T01:27:44.463+08:00  INFO 22801 --- [ntainer#0-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-rebalance_demo_group-2, groupId=rebalance_demo_group] (Re-)joining group
2025-07-30T01:27:44.463+08:00  INFO 22801 --- [ntainer#1-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-user_behavior_group_springboot-3, groupId=user_behavior_group_springboot] (Re-)joining group
2025-07-30T01:27:44.463+08:00  INFO 22801 --- [ntainer#2-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-user_behavior_group_springboot_manual-1, groupId=user_behavior_group_springboot_manual] Request joining group due to: need to re-join with the given member-id: consumer-user_behavior_group_springboot_manual-1-72a37e2d-40f1-4e43-827a-b147a0bc1ab0
2025-07-30T01:27:44.463+08:00  INFO 22801 --- [ntainer#2-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-user_behavior_group_springboot_manual-1, groupId=user_behavior_group_springboot_manual] Request joining group due to: rebalance failed due to 'The group member needs to have a valid member id before actually entering a consumer group.' (MemberIdRequiredException)
2025-07-30T01:27:44.463+08:00  INFO 22801 --- [ntainer#2-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-user_behavior_group_springboot_manual-1, groupId=user_behavior_group_springboot_manual] (Re-)joining group
2025-07-30T01:27:46.017+08:00  INFO 22801 --- [ntainer#2-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-user_behavior_group_springboot_manual-1, groupId=user_behavior_group_springboot_manual] Successfully joined group with generation Generation{generationId=39, memberId='consumer-user_behavior_group_springboot_manual-1-72a37e2d-40f1-4e43-827a-b147a0bc1ab0', protocol='range'}
2025-07-30T01:27:46.022+08:00  INFO 22801 --- [ntainer#1-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-user_behavior_group_springboot-3, groupId=user_behavior_group_springboot] Successfully joined group with generation Generation{generationId=42, memberId='consumer-user_behavior_group_springboot-3-2927932b-c72a-491f-b2f3-60e9f16ad136', protocol='range'}
2025-07-30T01:27:46.023+08:00  INFO 22801 --- [ntainer#2-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-user_behavior_group_springboot_manual-1, groupId=user_behavior_group_springboot_manual] Successfully synced group in generation Generation{generationId=39, memberId='consumer-user_behavior_group_springboot_manual-1-72a37e2d-40f1-4e43-827a-b147a0bc1ab0', protocol='range'}
2025-07-30T01:27:46.026+08:00  INFO 22801 --- [ntainer#2-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-user_behavior_group_springboot_manual-1, groupId=user_behavior_group_springboot_manual] Notifying assignor about the new Assignment(partitions=[user_behavior_logs-0, user_behavior_logs-1])
2025-07-30T01:27:46.027+08:00  INFO 22801 --- [ntainer#2-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-user_behavior_group_springboot_manual-1, groupId=user_behavior_group_springboot_manual] Adding newly assigned partitions: user_behavior_logs-0, user_behavior_logs-1
2025-07-30T01:27:46.029+08:00  INFO 22801 --- [ntainer#1-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-user_behavior_group_springboot-3, groupId=user_behavior_group_springboot] Successfully synced group in generation Generation{generationId=42, memberId='consumer-user_behavior_group_springboot-3-2927932b-c72a-491f-b2f3-60e9f16ad136', protocol='range'}
2025-07-30T01:27:46.029+08:00  INFO 22801 --- [ntainer#1-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-user_behavior_group_springboot-3, groupId=user_behavior_group_springboot] Notifying assignor about the new Assignment(partitions=[user_behavior_logs-0, user_behavior_logs-1])
2025-07-30T01:27:46.029+08:00  INFO 22801 --- [ntainer#1-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-user_behavior_group_springboot-3, groupId=user_behavior_group_springboot] Adding newly assigned partitions: user_behavior_logs-0, user_behavior_logs-1
2025-07-30T01:27:46.032+08:00  INFO 22801 --- [ntainer#2-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-user_behavior_group_springboot_manual-1, groupId=user_behavior_group_springboot_manual] Setting offset for partition user_behavior_logs-1 to the committed offset FetchPosition{offset=73, offsetEpoch=Optional.empty, currentLeader=LeaderAndEpoch{leader=Optional[localhost:9092 (id: 1 rack: null)], epoch=0}}
2025-07-30T01:27:46.032+08:00  INFO 22801 --- [ntainer#1-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-user_behavior_group_springboot-3, groupId=user_behavior_group_springboot] Setting offset for partition user_behavior_logs-1 to the committed offset FetchPosition{offset=73, offsetEpoch=Optional[0], currentLeader=LeaderAndEpoch{leader=Optional[localhost:9092 (id: 1 rack: null)], epoch=0}}
2025-07-30T01:27:46.032+08:00  INFO 22801 --- [ntainer#2-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-user_behavior_group_springboot_manual-1, groupId=user_behavior_group_springboot_manual] Setting offset for partition user_behavior_logs-0 to the committed offset FetchPosition{offset=93, offsetEpoch=Optional.empty, currentLeader=LeaderAndEpoch{leader=Optional[localhost:9092 (id: 1 rack: null)], epoch=0}}
2025-07-30T01:27:46.032+08:00  INFO 22801 --- [ntainer#1-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-user_behavior_group_springboot-3, groupId=user_behavior_group_springboot] Setting offset for partition user_behavior_logs-0 to the committed offset FetchPosition{offset=93, offsetEpoch=Optional[0], currentLeader=LeaderAndEpoch{leader=Optional[localhost:9092 (id: 1 rack: null)], epoch=0}}
2025-07-30T01:27:46.032+08:00  INFO 22801 --- [ntainer#2-0-C-1] o.s.k.l.KafkaMessageListenerContainer    : user_behavior_group_springboot_manual: partitions assigned: [user_behavior_logs-0, user_behavior_logs-1]
2025-07-30T01:27:46.038+08:00  INFO 22801 --- [ntainer#1-0-C-1] o.s.k.l.KafkaMessageListenerContainer    : user_behavior_group_springboot: partitions assigned: [user_behavior_logs-0, user_behavior_logs-1]
2025-07-30T01:27:46.123+08:00  INFO 22801 --- [ntainer#0-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-rebalance_demo_group-2, groupId=rebalance_demo_group] Successfully joined group with generation Generation{generationId=2, memberId='consumer-rebalance_demo_group-2-8a07e2c9-3610-4966-9ef9-c1748539e467', protocol='range'}
2025-07-30T01:27:46.130+08:00  INFO 22801 --- [ntainer#0-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-rebalance_demo_group-2, groupId=rebalance_demo_group] Successfully synced group in generation Generation{generationId=2, memberId='consumer-rebalance_demo_group-2-8a07e2c9-3610-4966-9ef9-c1748539e467', protocol='range'}
2025-07-30T01:27:46.131+08:00  INFO 22801 --- [ntainer#0-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-rebalance_demo_group-2, groupId=rebalance_demo_group] Notifying assignor about the new Assignment(partitions=[user_behavior_logs-0, user_behavior_logs-1])
2025-07-30T01:27:46.131+08:00  INFO 22801 --- [ntainer#0-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-rebalance_demo_group-2, groupId=rebalance_demo_group] Adding newly assigned partitions: user_behavior_logs-0, user_behavior_logs-1
2025-07-30T01:27:46.132+08:00  INFO 22801 --- [ntainer#0-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-rebalance_demo_group-2, groupId=rebalance_demo_group] Setting offset for partition user_behavior_logs-1 to the committed offset FetchPosition{offset=73, offsetEpoch=Optional[0], currentLeader=LeaderAndEpoch{leader=Optional[localhost:9092 (id: 1 rack: null)], epoch=0}}
2025-07-30T01:27:46.132+08:00  INFO 22801 --- [ntainer#0-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-rebalance_demo_group-2, groupId=rebalance_demo_group] Setting offset for partition user_behavior_logs-0 to the committed offset FetchPosition{offset=93, offsetEpoch=Optional[0], currentLeader=LeaderAndEpoch{leader=Optional[localhost:9092 (id: 1 rack: null)], epoch=0}}
2025-07-30T01:27:46.135+08:00  INFO 22801 --- [ntainer#0-0-C-1] s.h.service.RebalanceObserverService     : 📥 分区被分配 (Partitions Assigned) - 2025-07-30 01:27:46.135:
2025-07-30T01:27:46.135+08:00  INFO 22801 --- [ntainer#0-0-C-1] s.h.service.RebalanceObserverService     :    ✅ Topic: user_behavior_logs, Partition: 0 -> 当前消费者
2025-07-30T01:27:46.135+08:00  INFO 22801 --- [ntainer#0-0-C-1] s.h.service.RebalanceObserverService     :    ✅ Topic: user_behavior_logs, Partition: 1 -> 当前消费者
2025-07-30T01:27:46.135+08:00  INFO 22801 --- [ntainer#0-0-C-1] s.h.service.RebalanceObserverService     : === 再平衡完成 #0 - 2025-07-30 01:27:46.135 ===
2025-07-30T01:27:46.135+08:00  INFO 22801 --- [ntainer#0-0-C-1] s.h.service.RebalanceObserverService     : 🎉 消费者现在拥有 2 个分区
2025-07-30T01:27:46.135+08:00  INFO 22801 --- [ntainer#0-0-C-1] s.h.service.RebalanceObserverService     : 📊 当前分区分配摘要:
2025-07-30T01:27:46.135+08:00  INFO 22801 --- [ntainer#0-0-C-1] s.h.service.RebalanceObserverService     :    总分区数: 2
2025-07-30T01:27:46.136+08:00  INFO 22801 --- [ntainer#0-0-C-1] s.h.service.RebalanceObserverService     :    Topic 'user_behavior_logs': 分区 [0, 1]
2025-07-30T01:28:07.279+08:00  INFO 22801 --- [ntainer#2-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-user_behavior_group_springboot_manual-1, groupId=user_behavior_group_springboot_manual] Revoke previously assigned partitions user_behavior_logs-0, user_behavior_logs-1
2025-07-30T01:28:07.279+08:00  INFO 22801 --- [ntainer#1-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-user_behavior_group_springboot-3, groupId=user_behavior_group_springboot] Revoke previously assigned partitions user_behavior_logs-0, user_behavior_logs-1
2025-07-30T01:28:07.279+08:00  INFO 22801 --- [ntainer#0-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-rebalance_demo_group-2, groupId=rebalance_demo_group] Revoke previously assigned partitions user_behavior_logs-0, user_behavior_logs-1
2025-07-30T01:28:07.279+08:00  WARN 22801 --- [ntainer#0-0-C-1] s.h.service.RebalanceObserverService     : === 再平衡开始 #1 - 2025-07-30 01:28:07.279 ===
2025-07-30T01:28:07.279+08:00  WARN 22801 --- [ntainer#0-0-C-1] s.h.service.RebalanceObserverService     : 📤 分区被撤销 (Partitions Revoked):
2025-07-30T01:28:07.279+08:00  WARN 22801 --- [ntainer#0-0-C-1] s.h.service.RebalanceObserverService     :    ❌ Topic: user_behavior_logs, Partition: 0
2025-07-30T01:28:07.280+08:00  INFO 22801 --- [ntainer#2-0-C-1] o.s.k.l.KafkaMessageListenerContainer    : user_behavior_group_springboot_manual: partitions revoked: [user_behavior_logs-0, user_behavior_logs-1]
2025-07-30T01:28:07.280+08:00  WARN 22801 --- [ntainer#0-0-C-1] s.h.service.RebalanceObserverService     :    ❌ Topic: user_behavior_logs, Partition: 1
2025-07-30T01:28:07.280+08:00  INFO 22801 --- [ntainer#1-0-C-1] o.s.k.l.KafkaMessageListenerContainer    : user_behavior_group_springboot: partitions revoked: [user_behavior_logs-0, user_behavior_logs-1]
2025-07-30T01:28:07.280+08:00  WARN 22801 --- [ntainer#0-0-C-1] s.h.service.RebalanceObserverService     : 🔄 消费者正在释放分区所有权...
2025-07-30T01:28:07.280+08:00  INFO 22801 --- [ntainer#1-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-user_behavior_group_springboot-3, groupId=user_behavior_group_springboot] Member consumer-user_behavior_group_springboot-3-2927932b-c72a-491f-b2f3-60e9f16ad136 sending LeaveGroup request to coordinator localhost:9092 (id: 2147483646 rack: null) due to the consumer unsubscribed from all topics
2025-07-30T01:28:07.280+08:00  INFO 22801 --- [ntainer#2-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-user_behavior_group_springboot_manual-1, groupId=user_behavior_group_springboot_manual] Member consumer-user_behavior_group_springboot_manual-1-72a37e2d-40f1-4e43-827a-b147a0bc1ab0 sending LeaveGroup request to coordinator localhost:9092 (id: 2147483646 rack: null) due to the consumer unsubscribed from all topics
2025-07-30T01:28:07.281+08:00  INFO 22801 --- [ntainer#1-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-user_behavior_group_springboot-3, groupId=user_behavior_group_springboot] Resetting generation and member id due to: consumer pro-actively leaving the group
2025-07-30T01:28:07.281+08:00  INFO 22801 --- [ntainer#2-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-user_behavior_group_springboot_manual-1, groupId=user_behavior_group_springboot_manual] Resetting generation and member id due to: consumer pro-actively leaving the group
2025-07-30T01:28:07.281+08:00  INFO 22801 --- [ntainer#1-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-user_behavior_group_springboot-3, groupId=user_behavior_group_springboot] Request joining group due to: consumer pro-actively leaving the group
2025-07-30T01:28:07.281+08:00  INFO 22801 --- [ntainer#2-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-user_behavior_group_springboot_manual-1, groupId=user_behavior_group_springboot_manual] Request joining group due to: consumer pro-actively leaving the group
2025-07-30T01:28:07.281+08:00  INFO 22801 --- [ntainer#2-0-C-1] o.a.k.clients.consumer.KafkaConsumer     : [Consumer clientId=consumer-user_behavior_group_springboot_manual-1, groupId=user_behavior_group_springboot_manual] Unsubscribed all topics or patterns and assigned partitions
2025-07-30T01:28:07.281+08:00  INFO 22801 --- [ntainer#1-0-C-1] o.a.k.clients.consumer.KafkaConsumer     : [Consumer clientId=consumer-user_behavior_group_springboot-3, groupId=user_behavior_group_springboot] Unsubscribed all topics or patterns and assigned partitions
2025-07-30T01:28:07.281+08:00  INFO 22801 --- [ntainer#2-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-user_behavior_group_springboot_manual-1, groupId=user_behavior_group_springboot_manual] Resetting generation and member id due to: consumer pro-actively leaving the group
2025-07-30T01:28:07.281+08:00  INFO 22801 --- [ntainer#1-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-user_behavior_group_springboot-3, groupId=user_behavior_group_springboot] Resetting generation and member id due to: consumer pro-actively leaving the group
2025-07-30T01:28:07.281+08:00  INFO 22801 --- [ntainer#2-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-user_behavior_group_springboot_manual-1, groupId=user_behavior_group_springboot_manual] Request joining group due to: consumer pro-actively leaving the group
2025-07-30T01:28:07.281+08:00  INFO 22801 --- [ntainer#1-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-user_behavior_group_springboot-3, groupId=user_behavior_group_springboot] Request joining group due to: consumer pro-actively leaving the group
2025-07-30T01:28:07.282+08:00  INFO 22801 --- [ntainer#2-0-C-1] o.apache.kafka.common.metrics.Metrics    : Metrics scheduler closed
2025-07-30T01:28:07.282+08:00  INFO 22801 --- [ntainer#1-0-C-1] o.apache.kafka.common.metrics.Metrics    : Metrics scheduler closed
2025-07-30T01:28:07.282+08:00  INFO 22801 --- [ntainer#2-0-C-1] o.apache.kafka.common.metrics.Metrics    : Closing reporter org.apache.kafka.common.metrics.JmxReporter
2025-07-30T01:28:07.282+08:00  INFO 22801 --- [ntainer#1-0-C-1] o.apache.kafka.common.metrics.Metrics    : Closing reporter org.apache.kafka.common.metrics.JmxReporter
2025-07-30T01:28:07.283+08:00  INFO 22801 --- [ntainer#2-0-C-1] o.apache.kafka.common.metrics.Metrics    : Metrics reporters closed
2025-07-30T01:28:07.283+08:00  INFO 22801 --- [ntainer#1-0-C-1] o.apache.kafka.common.metrics.Metrics    : Metrics reporters closed
2025-07-30T01:28:07.287+08:00  INFO 22801 --- [ntainer#1-0-C-1] o.a.kafka.common.utils.AppInfoParser     : App info kafka.consumer for consumer-user_behavior_group_springboot-3 unregistered
2025-07-30T01:28:07.287+08:00  INFO 22801 --- [ntainer#2-0-C-1] o.a.kafka.common.utils.AppInfoParser     : App info kafka.consumer for consumer-user_behavior_group_springboot_manual-1 unregistered
2025-07-30T01:28:07.287+08:00  INFO 22801 --- [ntainer#1-0-C-1] o.s.k.l.KafkaMessageListenerContainer    : user_behavior_group_springboot: Consumer stopped
2025-07-30T01:28:07.287+08:00  INFO 22801 --- [ntainer#2-0-C-1] o.s.k.l.KafkaMessageListenerContainer    : user_behavior_group_springboot_manual: Consumer stopped
2025-07-30T01:28:07.380+08:00  INFO 22801 --- [ntainer#0-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-rebalance_demo_group-2, groupId=rebalance_demo_group] Member consumer-rebalance_demo_group-2-8a07e2c9-3610-4966-9ef9-c1748539e467 sending LeaveGroup request to coordinator localhost:9092 (id: 2147483646 rack: null) due to the consumer unsubscribed from all topics
2025-07-30T01:28:07.380+08:00  INFO 22801 --- [ntainer#0-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-rebalance_demo_group-2, groupId=rebalance_demo_group] Resetting generation and member id due to: consumer pro-actively leaving the group
2025-07-30T01:28:07.381+08:00  INFO 22801 --- [ntainer#0-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-rebalance_demo_group-2, groupId=rebalance_demo_group] Request joining group due to: consumer pro-actively leaving the group
2025-07-30T01:28:07.381+08:00  INFO 22801 --- [ntainer#0-0-C-1] o.a.k.clients.consumer.KafkaConsumer     : [Consumer clientId=consumer-rebalance_demo_group-2, groupId=rebalance_demo_group] Unsubscribed all topics or patterns and assigned partitions
2025-07-30T01:28:07.381+08:00  INFO 22801 --- [ntainer#0-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-rebalance_demo_group-2, groupId=rebalance_demo_group] Resetting generation and member id due to: consumer pro-actively leaving the group
2025-07-30T01:28:07.381+08:00  INFO 22801 --- [ntainer#0-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-rebalance_demo_group-2, groupId=rebalance_demo_group] Request joining group due to: consumer pro-actively leaving the group
2025-07-30T01:28:07.382+08:00  INFO 22801 --- [ntainer#0-0-C-1] o.apache.kafka.common.metrics.Metrics    : Metrics scheduler closed
2025-07-30T01:28:07.382+08:00  INFO 22801 --- [ntainer#0-0-C-1] o.apache.kafka.common.metrics.Metrics    : Closing reporter org.apache.kafka.common.metrics.JmxReporter
2025-07-30T01:28:07.382+08:00  INFO 22801 --- [ntainer#0-0-C-1] o.apache.kafka.common.metrics.Metrics    : Metrics reporters closed
2025-07-30T01:28:07.383+08:00  INFO 22801 --- [ntainer#0-0-C-1] o.a.kafka.common.utils.AppInfoParser     : App info kafka.consumer for consumer-rebalance_demo_group-2 unregistered
2025-07-30T01:28:07.383+08:00  INFO 22801 --- [ntainer#0-0-C-1] o.s.k.l.KafkaMessageListenerContainer    : rebalance_demo_group: Consumer stopped

进程已结束，退出代码为 130 (interrupted by signal 2:SIGINT)

我的操作流程是先开启一个实例 开启第二个实例 关闭第二个实例 能帮我挑选出来上面我提供的日志里面的最关键的部分告诉我再平衡是怎么做的吗？